{"ast":null,"code":"import _objectSpread from\"C:/laragon/www/folio-2019/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import*as THREE from'three';import Area from'./Area.js';export default class Areas{constructor(_options){// Options\nthis.config=_options.config;this.resources=_options.resources;this.car=_options.car;this.sounds=_options.sounds;this.renderer=_options.renderer;this.camera=_options.camera;this.time=_options.time;this.debug=_options.debug;// Set up\nthis.items=[];this.container=new THREE.Object3D();this.container.matrixAutoUpdate=false;this.setMouse();}setMouse(){// Set up\nthis.mouse={};this.mouse.raycaster=new THREE.Raycaster();this.mouse.coordinates=new THREE.Vector2();this.mouse.currentArea=null;this.mouse.needsUpdate=false;// Mouse move event\nwindow.addEventListener('mousemove',_event=>{this.mouse.coordinates.x=_event.clientX/window.innerWidth*2-1;this.mouse.coordinates.y=-(_event.clientY/window.innerHeight)*2+1;this.mouse.needsUpdate=true;});// Mouse click event\nwindow.addEventListener('mousedown',()=>{if(this.mouse.currentArea){this.mouse.currentArea.interact(false);}});// Touch\nthis.renderer.domElement.addEventListener('touchstart',_event=>{this.mouse.coordinates.x=_event.changedTouches[0].clientX/window.innerWidth*2-1;this.mouse.coordinates.y=-(_event.changedTouches[0].clientY/window.innerHeight)*2+1;this.mouse.needsUpdate=true;});// Time tick event\nthis.time.on('tick',()=>{// Only update if needed\nif(this.mouse.needsUpdate){this.mouse.needsUpdate=false;// Set up\nthis.mouse.raycaster.setFromCamera(this.mouse.coordinates,this.camera.instance);const objects=this.items.map(_area=>_area.mouseMesh);const intersects=this.mouse.raycaster.intersectObjects(objects);// Intersections found\nif(intersects.length){// Find the area\nconst area=this.items.find(_area=>_area.mouseMesh===intersects[0].object);// Area did change\nif(area!==this.mouse.currentArea){// Was previously over an area\nif(this.mouse.currentArea!==null){// Play out\nthis.mouse.currentArea.out();this.mouse.currentArea.testCar=this.mouse.currentArea.initialTestCar;}// Play in\nthis.mouse.currentArea=area;this.mouse.currentArea.in(false);this.mouse.currentArea.testCar=false;}}// No intersections found but was previously over an area\nelse if(this.mouse.currentArea!==null){// Play out\nthis.mouse.currentArea.out();this.mouse.currentArea.testCar=this.mouse.currentArea.initialTestCar;this.mouse.currentArea=null;}}});}add(_options){const area=new Area(_objectSpread({config:this.config,renderer:this.renderer,resources:this.resources,car:this.car,sounds:this.sounds,time:this.time,hasKey:true,testCar:true,active:true},_options));this.container.add(area.container);this.items.push(area);return area;}}","map":{"version":3,"names":["THREE","Area","Areas","constructor","_options","config","resources","car","sounds","renderer","camera","time","debug","items","container","Object3D","matrixAutoUpdate","setMouse","mouse","raycaster","Raycaster","coordinates","Vector2","currentArea","needsUpdate","window","addEventListener","_event","x","clientX","innerWidth","y","clientY","innerHeight","interact","domElement","changedTouches","on","setFromCamera","instance","objects","map","_area","mouseMesh","intersects","intersectObjects","length","area","find","object","out","testCar","initialTestCar","in","add","_objectSpread","hasKey","active","push"],"sources":["C:/laragon/www/folio-2019/src/javascript/World/Areas.js"],"sourcesContent":["import * as THREE from 'three'\r\n\r\nimport Area from './Area.js'\r\n\r\nexport default class Areas\r\n{\r\n    constructor(_options)\r\n    {\r\n        // Options\r\n        this.config = _options.config\r\n        this.resources = _options.resources\r\n        this.car = _options.car\r\n        this.sounds = _options.sounds\r\n        this.renderer = _options.renderer\r\n        this.camera = _options.camera\r\n        this.time = _options.time\r\n        this.debug = _options.debug\r\n\r\n        // Set up\r\n        this.items = []\r\n        this.container = new THREE.Object3D()\r\n        this.container.matrixAutoUpdate = false\r\n\r\n        this.setMouse()\r\n    }\r\n\r\n    setMouse()\r\n    {\r\n        // Set up\r\n        this.mouse = {}\r\n        this.mouse.raycaster = new THREE.Raycaster()\r\n        this.mouse.coordinates = new THREE.Vector2()\r\n        this.mouse.currentArea = null\r\n        this.mouse.needsUpdate = false\r\n\r\n        // Mouse move event\r\n        window.addEventListener('mousemove', (_event) =>\r\n        {\r\n            this.mouse.coordinates.x = (_event.clientX / window.innerWidth) * 2 - 1\r\n            this.mouse.coordinates.y = - (_event.clientY / window.innerHeight) * 2 + 1\r\n\r\n            this.mouse.needsUpdate = true\r\n        })\r\n\r\n        // Mouse click event\r\n        window.addEventListener('mousedown', () =>\r\n        {\r\n            if(this.mouse.currentArea)\r\n            {\r\n                this.mouse.currentArea.interact(false)\r\n            }\r\n        })\r\n\r\n        // Touch\r\n        this.renderer.domElement.addEventListener('touchstart', (_event) =>\r\n        {\r\n            this.mouse.coordinates.x = (_event.changedTouches[0].clientX / window.innerWidth) * 2 - 1\r\n            this.mouse.coordinates.y = - (_event.changedTouches[0].clientY / window.innerHeight) * 2 + 1\r\n\r\n            this.mouse.needsUpdate = true\r\n        })\r\n\r\n        // Time tick event\r\n        this.time.on('tick', () =>\r\n        {\r\n            // Only update if needed\r\n            if(this.mouse.needsUpdate)\r\n            {\r\n                this.mouse.needsUpdate = false\r\n\r\n                // Set up\r\n                this.mouse.raycaster.setFromCamera(this.mouse.coordinates, this.camera.instance)\r\n                const objects = this.items.map((_area) => _area.mouseMesh)\r\n                const intersects = this.mouse.raycaster.intersectObjects(objects)\r\n\r\n                // Intersections found\r\n                if(intersects.length)\r\n                {\r\n                    // Find the area\r\n                    const area = this.items.find((_area) => _area.mouseMesh === intersects[0].object)\r\n\r\n                    // Area did change\r\n                    if(area !== this.mouse.currentArea)\r\n                    {\r\n                        // Was previously over an area\r\n                        if(this.mouse.currentArea !== null)\r\n                        {\r\n                            // Play out\r\n                            this.mouse.currentArea.out()\r\n                            this.mouse.currentArea.testCar = this.mouse.currentArea.initialTestCar\r\n                        }\r\n\r\n                        // Play in\r\n                        this.mouse.currentArea = area\r\n                        this.mouse.currentArea.in(false)\r\n                        this.mouse.currentArea.testCar = false\r\n                    }\r\n                }\r\n                // No intersections found but was previously over an area\r\n                else if(this.mouse.currentArea !== null)\r\n                {\r\n                    // Play out\r\n                    this.mouse.currentArea.out()\r\n                    this.mouse.currentArea.testCar = this.mouse.currentArea.initialTestCar\r\n                    this.mouse.currentArea = null\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    add(_options)\r\n    {\r\n        const area = new Area({\r\n            config: this.config,\r\n            renderer: this.renderer,\r\n            resources: this.resources,\r\n            car: this.car,\r\n            sounds: this.sounds,\r\n            time: this.time,\r\n            hasKey: true,\r\n            testCar: true,\r\n            active: true,\r\n            ..._options\r\n        })\r\n\r\n        this.container.add(area.container)\r\n\r\n        this.items.push(area)\r\n\r\n        return area\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}