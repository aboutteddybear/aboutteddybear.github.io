{"ast":null,"code":"import*as THREE from'three';import ShadowMaterial from'../Materials/Shadow.js';import{TransformControls}from'three/examples/jsm/controls/TransformControls.js';export default class Shadows{constructor(_options){// Options\nthis.time=_options.time;this.debug=_options.debug;this.renderer=_options.renderer;this.camera=_options.camera;// Set up\nthis.alpha=0;this.maxDistance=3;this.distancePower=2;this.zFightingDistance=0.001;this.color='#d04500';this.wireframeVisible=false;this.items=[];this.container=new THREE.Object3D();this.container.matrixAutoUpdate=false;this.container.updateMatrix();// Debug\nif(this.debug){this.debugFolder=this.debug.addFolder('shadows');// this.debugFolder.open()\nthis.debugFolder.add(this,'alpha').step(0.01).min(0).max(1);this.debugFolder.add(this,'maxDistance').step(0.01).min(0).max(10);this.debugFolder.add(this,'distancePower').step(0.01).min(1).max(5);this.debugFolder.add(this,'wireframeVisible').name('wireframeVisible').onChange(()=>{for(const _shadow of this.items){_shadow.mesh.material=this.wireframeVisible?this.materials.wireframe:_shadow.material;}});this.debugFolder.addColor(this,'color').onChange(()=>{this.materials.base.uniforms.uColor.value=new THREE.Color(this.color);for(const _shadow of this.items){_shadow.material.uniforms.uColor.value=new THREE.Color(this.color);}});}this.setSun();this.setMaterials();this.setGeometry();this.setHelper();// Time tick\nthis.time.on('tick',()=>{for(const _shadow of this.items){// Position\nconst z=Math.max(_shadow.reference.position.z+_shadow.offsetZ,0);const sunOffset=this.sun.vector.clone().multiplyScalar(z);_shadow.mesh.position.x=_shadow.reference.position.x+sunOffset.x;_shadow.mesh.position.y=_shadow.reference.position.y+sunOffset.y;// Angle\n// Project the rotation as a vector on a plane and extract the angle\nconst rotationVector=new THREE.Vector3(1,0,0);rotationVector.applyQuaternion(_shadow.reference.quaternion);// const planeVector = new THREE.Vector3(0, 0, 1)\n// planeVector.normalize()\nconst projectedRotationVector=rotationVector.clone().projectOnPlane(new THREE.Vector3(0,0,1));let orientationAlpha=Math.abs(rotationVector.angleTo(new THREE.Vector3(0,0,1))-Math.PI*0.5)/(Math.PI*0.5);orientationAlpha/=0.5;orientationAlpha-=1/0.5;orientationAlpha=Math.abs(orientationAlpha);orientationAlpha=Math.min(Math.max(orientationAlpha,0),1);const angle=Math.atan2(projectedRotationVector.y,projectedRotationVector.x);_shadow.mesh.rotation.z=angle;// Alpha\nlet alpha=(this.maxDistance-z)/this.maxDistance;alpha=Math.min(Math.max(alpha,0),1);alpha=Math.pow(alpha,this.distancePower);_shadow.material.uniforms.uAlpha.value=this.alpha*_shadow.alpha*orientationAlpha*alpha;}});}setSun(){this.sun={};this.sun.position=new THREE.Vector3(-2.5,-2.65,3.75);this.sun.vector=new THREE.Vector3();this.sun.helper=new THREE.ArrowHelper(new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,0),1,0xffffff,0.1,0.4);this.sun.helper.visible=false;this.container.add(this.sun.helper);this.sun.update=()=>{this.sun.vector.copy(this.sun.position).multiplyScalar(1/this.sun.position.z).negate();this.sun.helper.position.copy(this.sun.position);const direction=this.sun.position.clone().negate().normalize();this.sun.helper.setDirection(direction);this.sun.helper.setLength(this.sun.helper.position.length());};this.sun.update();// Debug\nif(this.debug){const folder=this.debugFolder.addFolder('sun');folder.open();folder.add(this.sun.position,'x').step(0.01).min(-10).max(10).name('sunX').onChange(this.sun.update);folder.add(this.sun.position,'y').step(0.01).min(-10).max(10).name('sunY').onChange(this.sun.update);folder.add(this.sun.position,'z').step(0.01).min(0).max(10).name('sunZ').onChange(this.sun.update);folder.add(this.sun.helper,'visible').name('sunHelperVisible');}}setMaterials(){// Wireframe\nthis.materials={};this.materials.wireframe=new THREE.MeshBasicMaterial({color:0xffffff,wireframe:true});// Base\nthis.materials.base=new ShadowMaterial();this.materials.base.depthWrite=false;this.materials.base.uniforms.uColor.value=new THREE.Color(this.color);this.materials.base.uniforms.uAlpha.value=0;this.materials.base.uniforms.uFadeRadius.value=0.35;}setGeometry(){this.geometry=new THREE.PlaneGeometry(1,1,1,1);}setHelper(){if(!this.debug){return;}this.helper={};this.helper.active=false;this.helper.mesh=new THREE.Mesh(new THREE.BoxGeometry(3,1,1,1),new THREE.MeshNormalMaterial());this.helper.mesh.position.z=1.5;this.helper.mesh.position.y=-3;this.helper.mesh.visible=this.helper.active;this.container.add(this.helper.mesh);this.helper.transformControls=new TransformControls(this.camera.instance,this.renderer.domElement);this.helper.transformControls.size=0.5;this.helper.transformControls.attach(this.helper.mesh);this.helper.transformControls.visible=this.helper.active;this.helper.transformControls.enabled=this.helper.active;this.helper.shadow=this.add(this.helper.mesh,{sizeX:6,sizeY:2,offsetZ:-0.35,alpha:0.99});this.helper.shadow.mesh.visible=this.helper.active;document.addEventListener('keydown',_event=>{if(_event.key==='r'){this.helper.transformControls.setMode('rotate');}else if(_event.key==='g'){this.helper.transformControls.setMode('translate');}});this.helper.transformControls.addEventListener('dragging-changed',_event=>{this.camera.orbitControls.enabled=!_event.value;});this.container.add(this.helper.transformControls);// Debug\nif(this.debug){const folder=this.debugFolder.addFolder('helper');folder.open();folder.add(this.helper,'active').name('visible').onChange(()=>{this.helper.mesh.visible=this.helper.active;this.helper.transformControls.visible=this.helper.active;this.helper.transformControls.enabled=this.helper.active;this.helper.shadow.mesh.visible=this.helper.active;});}}add(_reference){let _options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const shadow={};// Options\nshadow.offsetZ=typeof _options.offsetZ==='undefined'?0:_options.offsetZ;shadow.alpha=typeof _options.alpha==='undefined'?1:_options.alpha;// Reference\nshadow.reference=_reference;// Material\nshadow.material=this.materials.base.clone();// Mesh\nshadow.mesh=new THREE.Mesh(this.geometry,this.wireframeVisible?this.materials.wireframe:shadow.material);shadow.mesh.position.z=this.zFightingDistance;shadow.mesh.scale.set(_options.sizeX,_options.sizeY,2.4);// Save\nthis.container.add(shadow.mesh);this.items.push(shadow);return shadow;}}","map":{"version":3,"names":["THREE","ShadowMaterial","TransformControls","Shadows","constructor","_options","time","debug","renderer","camera","alpha","maxDistance","distancePower","zFightingDistance","color","wireframeVisible","items","container","Object3D","matrixAutoUpdate","updateMatrix","debugFolder","addFolder","add","step","min","max","name","onChange","_shadow","mesh","material","materials","wireframe","addColor","base","uniforms","uColor","value","Color","setSun","setMaterials","setGeometry","setHelper","on","z","Math","reference","position","offsetZ","sunOffset","sun","vector","clone","multiplyScalar","x","y","rotationVector","Vector3","applyQuaternion","quaternion","projectedRotationVector","projectOnPlane","orientationAlpha","abs","angleTo","PI","angle","atan2","rotation","pow","uAlpha","helper","ArrowHelper","visible","update","copy","negate","direction","normalize","setDirection","setLength","length","folder","open","MeshBasicMaterial","depthWrite","uFadeRadius","geometry","PlaneGeometry","active","Mesh","BoxGeometry","MeshNormalMaterial","transformControls","instance","domElement","size","attach","enabled","shadow","sizeX","sizeY","document","addEventListener","_event","key","setMode","orbitControls","_reference","arguments","undefined","scale","set","push"],"sources":["C:/laragon/www/folio-2019/src/javascript/World/Shadows.js"],"sourcesContent":["import * as THREE from 'three'\r\nimport ShadowMaterial from '../Materials/Shadow.js'\r\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls.js'\r\n\r\nexport default class Shadows\r\n{\r\n    constructor(_options)\r\n    {\r\n        // Options\r\n        this.time = _options.time\r\n        this.debug = _options.debug\r\n        this.renderer = _options.renderer\r\n        this.camera = _options.camera\r\n\r\n        // Set up\r\n        this.alpha = 0\r\n        this.maxDistance = 3\r\n        this.distancePower = 2\r\n        this.zFightingDistance = 0.001\r\n        this.color = '#d04500'\r\n        this.wireframeVisible = false\r\n        this.items = []\r\n\r\n        this.container = new THREE.Object3D()\r\n        this.container.matrixAutoUpdate = false\r\n        this.container.updateMatrix()\r\n\r\n        // Debug\r\n        if(this.debug)\r\n        {\r\n            this.debugFolder = this.debug.addFolder('shadows')\r\n            // this.debugFolder.open()\r\n\r\n            this.debugFolder.add(this, 'alpha').step(0.01).min(0).max(1)\r\n            this.debugFolder.add(this, 'maxDistance').step(0.01).min(0).max(10)\r\n            this.debugFolder.add(this, 'distancePower').step(0.01).min(1).max(5)\r\n            this.debugFolder.add(this, 'wireframeVisible').name('wireframeVisible').onChange(() =>\r\n            {\r\n                for(const _shadow of this.items)\r\n                {\r\n                    _shadow.mesh.material = this.wireframeVisible ? this.materials.wireframe : _shadow.material\r\n                }\r\n            })\r\n\r\n            this.debugFolder.addColor(this, 'color').onChange(() =>\r\n            {\r\n                this.materials.base.uniforms.uColor.value = new THREE.Color(this.color)\r\n\r\n                for(const _shadow of this.items)\r\n                {\r\n                    _shadow.material.uniforms.uColor.value = new THREE.Color(this.color)\r\n                }\r\n            })\r\n        }\r\n\r\n        this.setSun()\r\n        this.setMaterials()\r\n        this.setGeometry()\r\n        this.setHelper()\r\n\r\n        // Time tick\r\n        this.time.on('tick', () =>\r\n        {\r\n            for(const _shadow of this.items)\r\n            {\r\n                // Position\r\n                const z = Math.max(_shadow.reference.position.z + _shadow.offsetZ, 0)\r\n                const sunOffset = this.sun.vector.clone().multiplyScalar(z)\r\n\r\n                _shadow.mesh.position.x = _shadow.reference.position.x + sunOffset.x\r\n                _shadow.mesh.position.y = _shadow.reference.position.y + sunOffset.y\r\n\r\n                // Angle\r\n                // Project the rotation as a vector on a plane and extract the angle\r\n                const rotationVector = new THREE.Vector3(1, 0, 0)\r\n                rotationVector.applyQuaternion(_shadow.reference.quaternion)\r\n                // const planeVector = new THREE.Vector3(0, 0, 1)\r\n                // planeVector.normalize()\r\n                const projectedRotationVector = rotationVector.clone().projectOnPlane(new THREE.Vector3(0, 0, 1))\r\n\r\n                let orientationAlpha = Math.abs(rotationVector.angleTo(new THREE.Vector3(0, 0, 1)) - Math.PI * 0.5) / (Math.PI * 0.5)\r\n                orientationAlpha /= 0.5\r\n                orientationAlpha -= 1 / 0.5\r\n                orientationAlpha = Math.abs(orientationAlpha)\r\n                orientationAlpha = Math.min(Math.max(orientationAlpha, 0), 1)\r\n\r\n                const angle = Math.atan2(projectedRotationVector.y, projectedRotationVector.x)\r\n                _shadow.mesh.rotation.z = angle\r\n\r\n                // Alpha\r\n                let alpha = (this.maxDistance - z) / this.maxDistance\r\n                alpha = Math.min(Math.max(alpha, 0), 1)\r\n                alpha = Math.pow(alpha, this.distancePower)\r\n\r\n                _shadow.material.uniforms.uAlpha.value = this.alpha * _shadow.alpha * orientationAlpha * alpha\r\n            }\r\n        })\r\n    }\r\n\r\n    setSun()\r\n    {\r\n        this.sun = {}\r\n        this.sun.position = new THREE.Vector3(- 2.5, - 2.65, 3.75)\r\n        this.sun.vector = new THREE.Vector3()\r\n        this.sun.helper = new THREE.ArrowHelper(new THREE.Vector3(0, 0, 1), new THREE.Vector3(0, 0, 0), 1, 0xffffff, 0.1, 0.4)\r\n        this.sun.helper.visible = false\r\n        this.container.add(this.sun.helper)\r\n\r\n        this.sun.update = () =>\r\n        {\r\n            this.sun.vector.copy(this.sun.position).multiplyScalar(1 / this.sun.position.z).negate()\r\n            this.sun.helper.position.copy(this.sun.position)\r\n\r\n            const direction = this.sun.position.clone().negate().normalize()\r\n\r\n            this.sun.helper.setDirection(direction)\r\n            this.sun.helper.setLength(this.sun.helper.position.length())\r\n        }\r\n\r\n        this.sun.update()\r\n\r\n        // Debug\r\n        if(this.debug)\r\n        {\r\n            const folder = this.debugFolder.addFolder('sun')\r\n            folder.open()\r\n\r\n            folder.add(this.sun.position, 'x').step(0.01).min(- 10).max(10).name('sunX').onChange(this.sun.update)\r\n            folder.add(this.sun.position, 'y').step(0.01).min(- 10).max(10).name('sunY').onChange(this.sun.update)\r\n            folder.add(this.sun.position, 'z').step(0.01).min(0).max(10).name('sunZ').onChange(this.sun.update)\r\n            folder.add(this.sun.helper, 'visible').name('sunHelperVisible')\r\n        }\r\n    }\r\n\r\n    setMaterials()\r\n    {\r\n        // Wireframe\r\n        this.materials = {}\r\n        this.materials.wireframe = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true })\r\n\r\n        // Base\r\n        this.materials.base = new ShadowMaterial()\r\n        this.materials.base.depthWrite = false\r\n        this.materials.base.uniforms.uColor.value = new THREE.Color(this.color)\r\n        this.materials.base.uniforms.uAlpha.value = 0\r\n        this.materials.base.uniforms.uFadeRadius.value = 0.35\r\n    }\r\n\r\n    setGeometry()\r\n    {\r\n        this.geometry = new THREE.PlaneGeometry(1, 1, 1, 1)\r\n    }\r\n\r\n    setHelper()\r\n    {\r\n        if(!this.debug)\r\n        {\r\n            return\r\n        }\r\n\r\n        this.helper = {}\r\n\r\n        this.helper.active = false\r\n\r\n        this.helper.mesh = new THREE.Mesh(new THREE.BoxGeometry(3, 1, 1, 1), new THREE.MeshNormalMaterial())\r\n        this.helper.mesh.position.z = 1.5\r\n        this.helper.mesh.position.y = - 3\r\n        this.helper.mesh.visible = this.helper.active\r\n        this.container.add(this.helper.mesh)\r\n\r\n        this.helper.transformControls = new TransformControls(this.camera.instance, this.renderer.domElement)\r\n        this.helper.transformControls.size = 0.5\r\n        this.helper.transformControls.attach(this.helper.mesh)\r\n        this.helper.transformControls.visible = this.helper.active\r\n        this.helper.transformControls.enabled = this.helper.active\r\n\r\n        this.helper.shadow = this.add(this.helper.mesh, { sizeX: 6, sizeY: 2, offsetZ: - 0.35, alpha: 0.99 })\r\n        this.helper.shadow.mesh.visible = this.helper.active\r\n\r\n        document.addEventListener('keydown', (_event) =>\r\n        {\r\n            if(_event.key === 'r')\r\n            {\r\n                this.helper.transformControls.setMode('rotate')\r\n            }\r\n            else if(_event.key === 'g')\r\n            {\r\n                this.helper.transformControls.setMode('translate')\r\n            }\r\n        })\r\n\r\n        this.helper.transformControls.addEventListener('dragging-changed', (_event) =>\r\n        {\r\n            this.camera.orbitControls.enabled = !_event.value\r\n        })\r\n\r\n        this.container.add(this.helper.transformControls)\r\n\r\n        // Debug\r\n        if(this.debug)\r\n        {\r\n            const folder = this.debugFolder.addFolder('helper')\r\n            folder.open()\r\n\r\n            folder.add(this.helper, 'active').name('visible').onChange(() =>\r\n            {\r\n                this.helper.mesh.visible = this.helper.active\r\n\r\n                this.helper.transformControls.visible = this.helper.active\r\n                this.helper.transformControls.enabled = this.helper.active\r\n\r\n                this.helper.shadow.mesh.visible = this.helper.active\r\n            })\r\n        }\r\n    }\r\n\r\n    add(_reference, _options = {})\r\n    {\r\n        const shadow = {}\r\n\r\n        // Options\r\n        shadow.offsetZ = typeof _options.offsetZ === 'undefined' ? 0 : _options.offsetZ\r\n        shadow.alpha = typeof _options.alpha === 'undefined' ? 1 : _options.alpha\r\n\r\n        // Reference\r\n        shadow.reference = _reference\r\n\r\n        // Material\r\n        shadow.material = this.materials.base.clone()\r\n\r\n        // Mesh\r\n        shadow.mesh = new THREE.Mesh(this.geometry, this.wireframeVisible ? this.materials.wireframe : shadow.material)\r\n        shadow.mesh.position.z = this.zFightingDistance\r\n        shadow.mesh.scale.set(_options.sizeX, _options.sizeY, 2.4)\r\n\r\n        // Save\r\n        this.container.add(shadow.mesh)\r\n        this.items.push(shadow)\r\n\r\n        return shadow\r\n    }\r\n}\r\n"],"mappings":"AAAA,MAAO,GAAK,CAAAA,KAAK,KAAM,OAAO,CAC9B,MAAO,CAAAC,cAAc,KAAM,wBAAwB,CACnD,OAASC,iBAAiB,KAAQ,kDAAkD,CAEpF,cAAe,MAAM,CAAAC,OACrB,CACIC,WAAWA,CAACC,QAAQ,CACpB,CACI;AACA,IAAI,CAACC,IAAI,CAAGD,QAAQ,CAACC,IAAI,CACzB,IAAI,CAACC,KAAK,CAAGF,QAAQ,CAACE,KAAK,CAC3B,IAAI,CAACC,QAAQ,CAAGH,QAAQ,CAACG,QAAQ,CACjC,IAAI,CAACC,MAAM,CAAGJ,QAAQ,CAACI,MAAM,CAE7B;AACA,IAAI,CAACC,KAAK,CAAG,CAAC,CACd,IAAI,CAACC,WAAW,CAAG,CAAC,CACpB,IAAI,CAACC,aAAa,CAAG,CAAC,CACtB,IAAI,CAACC,iBAAiB,CAAG,KAAK,CAC9B,IAAI,CAACC,KAAK,CAAG,SAAS,CACtB,IAAI,CAACC,gBAAgB,CAAG,KAAK,CAC7B,IAAI,CAACC,KAAK,CAAG,EAAE,CAEf,IAAI,CAACC,SAAS,CAAG,GAAI,CAAAjB,KAAK,CAACkB,QAAQ,CAAC,CAAC,CACrC,IAAI,CAACD,SAAS,CAACE,gBAAgB,CAAG,KAAK,CACvC,IAAI,CAACF,SAAS,CAACG,YAAY,CAAC,CAAC,CAE7B;AACA,GAAG,IAAI,CAACb,KAAK,CACb,CACI,IAAI,CAACc,WAAW,CAAG,IAAI,CAACd,KAAK,CAACe,SAAS,CAAC,SAAS,CAAC,CAClD;AAEA,IAAI,CAACD,WAAW,CAACE,GAAG,CAAC,IAAI,CAAE,OAAO,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAC5D,IAAI,CAACL,WAAW,CAACE,GAAG,CAAC,IAAI,CAAE,aAAa,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CACnE,IAAI,CAACL,WAAW,CAACE,GAAG,CAAC,IAAI,CAAE,eAAe,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CACpE,IAAI,CAACL,WAAW,CAACE,GAAG,CAAC,IAAI,CAAE,kBAAkB,CAAC,CAACI,IAAI,CAAC,kBAAkB,CAAC,CAACC,QAAQ,CAAC,IACjF,CACI,IAAI,KAAM,CAAAC,OAAO,GAAI,KAAI,CAACb,KAAK,CAC/B,CACIa,OAAO,CAACC,IAAI,CAACC,QAAQ,CAAG,IAAI,CAAChB,gBAAgB,CAAG,IAAI,CAACiB,SAAS,CAACC,SAAS,CAAGJ,OAAO,CAACE,QAAQ,CAC/F,CACJ,CAAC,CAAC,CAEF,IAAI,CAACV,WAAW,CAACa,QAAQ,CAAC,IAAI,CAAE,OAAO,CAAC,CAACN,QAAQ,CAAC,IAClD,CACI,IAAI,CAACI,SAAS,CAACG,IAAI,CAACC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAG,GAAI,CAAAtC,KAAK,CAACuC,KAAK,CAAC,IAAI,CAACzB,KAAK,CAAC,CAEvE,IAAI,KAAM,CAAAe,OAAO,GAAI,KAAI,CAACb,KAAK,CAC/B,CACIa,OAAO,CAACE,QAAQ,CAACK,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAG,GAAI,CAAAtC,KAAK,CAACuC,KAAK,CAAC,IAAI,CAACzB,KAAK,CAAC,CACxE,CACJ,CAAC,CAAC,CACN,CAEA,IAAI,CAAC0B,MAAM,CAAC,CAAC,CACb,IAAI,CAACC,YAAY,CAAC,CAAC,CACnB,IAAI,CAACC,WAAW,CAAC,CAAC,CAClB,IAAI,CAACC,SAAS,CAAC,CAAC,CAEhB;AACA,IAAI,CAACrC,IAAI,CAACsC,EAAE,CAAC,MAAM,CAAE,IACrB,CACI,IAAI,KAAM,CAAAf,OAAO,GAAI,KAAI,CAACb,KAAK,CAC/B,CACI;AACA,KAAM,CAAA6B,CAAC,CAAGC,IAAI,CAACpB,GAAG,CAACG,OAAO,CAACkB,SAAS,CAACC,QAAQ,CAACH,CAAC,CAAGhB,OAAO,CAACoB,OAAO,CAAE,CAAC,CAAC,CACrE,KAAM,CAAAC,SAAS,CAAG,IAAI,CAACC,GAAG,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAACC,cAAc,CAACT,CAAC,CAAC,CAE3DhB,OAAO,CAACC,IAAI,CAACkB,QAAQ,CAACO,CAAC,CAAG1B,OAAO,CAACkB,SAAS,CAACC,QAAQ,CAACO,CAAC,CAAGL,SAAS,CAACK,CAAC,CACpE1B,OAAO,CAACC,IAAI,CAACkB,QAAQ,CAACQ,CAAC,CAAG3B,OAAO,CAACkB,SAAS,CAACC,QAAQ,CAACQ,CAAC,CAAGN,SAAS,CAACM,CAAC,CAEpE;AACA;AACA,KAAM,CAAAC,cAAc,CAAG,GAAI,CAAAzD,KAAK,CAAC0D,OAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CACjDD,cAAc,CAACE,eAAe,CAAC9B,OAAO,CAACkB,SAAS,CAACa,UAAU,CAAC,CAC5D;AACA;AACA,KAAM,CAAAC,uBAAuB,CAAGJ,cAAc,CAACJ,KAAK,CAAC,CAAC,CAACS,cAAc,CAAC,GAAI,CAAA9D,KAAK,CAAC0D,OAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAC,CAEjG,GAAI,CAAAK,gBAAgB,CAAGjB,IAAI,CAACkB,GAAG,CAACP,cAAc,CAACQ,OAAO,CAAC,GAAI,CAAAjE,KAAK,CAAC0D,OAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAC,CAAGZ,IAAI,CAACoB,EAAE,CAAG,GAAG,CAAC,EAAIpB,IAAI,CAACoB,EAAE,CAAG,GAAG,CAAC,CACrHH,gBAAgB,EAAI,GAAG,CACvBA,gBAAgB,EAAI,CAAC,CAAG,GAAG,CAC3BA,gBAAgB,CAAGjB,IAAI,CAACkB,GAAG,CAACD,gBAAgB,CAAC,CAC7CA,gBAAgB,CAAGjB,IAAI,CAACrB,GAAG,CAACqB,IAAI,CAACpB,GAAG,CAACqC,gBAAgB,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CAE7D,KAAM,CAAAI,KAAK,CAAGrB,IAAI,CAACsB,KAAK,CAACP,uBAAuB,CAACL,CAAC,CAAEK,uBAAuB,CAACN,CAAC,CAAC,CAC9E1B,OAAO,CAACC,IAAI,CAACuC,QAAQ,CAACxB,CAAC,CAAGsB,KAAK,CAE/B;AACA,GAAI,CAAAzD,KAAK,CAAG,CAAC,IAAI,CAACC,WAAW,CAAGkC,CAAC,EAAI,IAAI,CAAClC,WAAW,CACrDD,KAAK,CAAGoC,IAAI,CAACrB,GAAG,CAACqB,IAAI,CAACpB,GAAG,CAAChB,KAAK,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CACvCA,KAAK,CAAGoC,IAAI,CAACwB,GAAG,CAAC5D,KAAK,CAAE,IAAI,CAACE,aAAa,CAAC,CAE3CiB,OAAO,CAACE,QAAQ,CAACK,QAAQ,CAACmC,MAAM,CAACjC,KAAK,CAAG,IAAI,CAAC5B,KAAK,CAAGmB,OAAO,CAACnB,KAAK,CAAGqD,gBAAgB,CAAGrD,KAAK,CAClG,CACJ,CAAC,CAAC,CACN,CAEA8B,MAAMA,CAAA,CACN,CACI,IAAI,CAACW,GAAG,CAAG,CAAC,CAAC,CACb,IAAI,CAACA,GAAG,CAACH,QAAQ,CAAG,GAAI,CAAAhD,KAAK,CAAC0D,OAAO,CAAC,CAAE,GAAG,CAAE,CAAE,IAAI,CAAE,IAAI,CAAC,CAC1D,IAAI,CAACP,GAAG,CAACC,MAAM,CAAG,GAAI,CAAApD,KAAK,CAAC0D,OAAO,CAAC,CAAC,CACrC,IAAI,CAACP,GAAG,CAACqB,MAAM,CAAG,GAAI,CAAAxE,KAAK,CAACyE,WAAW,CAAC,GAAI,CAAAzE,KAAK,CAAC0D,OAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAE,GAAI,CAAA1D,KAAK,CAAC0D,OAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,QAAQ,CAAE,GAAG,CAAE,GAAG,CAAC,CACtH,IAAI,CAACP,GAAG,CAACqB,MAAM,CAACE,OAAO,CAAG,KAAK,CAC/B,IAAI,CAACzD,SAAS,CAACM,GAAG,CAAC,IAAI,CAAC4B,GAAG,CAACqB,MAAM,CAAC,CAEnC,IAAI,CAACrB,GAAG,CAACwB,MAAM,CAAG,IAClB,CACI,IAAI,CAACxB,GAAG,CAACC,MAAM,CAACwB,IAAI,CAAC,IAAI,CAACzB,GAAG,CAACH,QAAQ,CAAC,CAACM,cAAc,CAAC,CAAC,CAAG,IAAI,CAACH,GAAG,CAACH,QAAQ,CAACH,CAAC,CAAC,CAACgC,MAAM,CAAC,CAAC,CACxF,IAAI,CAAC1B,GAAG,CAACqB,MAAM,CAACxB,QAAQ,CAAC4B,IAAI,CAAC,IAAI,CAACzB,GAAG,CAACH,QAAQ,CAAC,CAEhD,KAAM,CAAA8B,SAAS,CAAG,IAAI,CAAC3B,GAAG,CAACH,QAAQ,CAACK,KAAK,CAAC,CAAC,CAACwB,MAAM,CAAC,CAAC,CAACE,SAAS,CAAC,CAAC,CAEhE,IAAI,CAAC5B,GAAG,CAACqB,MAAM,CAACQ,YAAY,CAACF,SAAS,CAAC,CACvC,IAAI,CAAC3B,GAAG,CAACqB,MAAM,CAACS,SAAS,CAAC,IAAI,CAAC9B,GAAG,CAACqB,MAAM,CAACxB,QAAQ,CAACkC,MAAM,CAAC,CAAC,CAAC,CAChE,CAAC,CAED,IAAI,CAAC/B,GAAG,CAACwB,MAAM,CAAC,CAAC,CAEjB;AACA,GAAG,IAAI,CAACpE,KAAK,CACb,CACI,KAAM,CAAA4E,MAAM,CAAG,IAAI,CAAC9D,WAAW,CAACC,SAAS,CAAC,KAAK,CAAC,CAChD6D,MAAM,CAACC,IAAI,CAAC,CAAC,CAEbD,MAAM,CAAC5D,GAAG,CAAC,IAAI,CAAC4B,GAAG,CAACH,QAAQ,CAAE,GAAG,CAAC,CAACxB,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAE,EAAE,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC,CAACC,QAAQ,CAAC,IAAI,CAACuB,GAAG,CAACwB,MAAM,CAAC,CACtGQ,MAAM,CAAC5D,GAAG,CAAC,IAAI,CAAC4B,GAAG,CAACH,QAAQ,CAAE,GAAG,CAAC,CAACxB,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAE,EAAE,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC,CAACC,QAAQ,CAAC,IAAI,CAACuB,GAAG,CAACwB,MAAM,CAAC,CACtGQ,MAAM,CAAC5D,GAAG,CAAC,IAAI,CAAC4B,GAAG,CAACH,QAAQ,CAAE,GAAG,CAAC,CAACxB,IAAI,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,EAAE,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC,CAACC,QAAQ,CAAC,IAAI,CAACuB,GAAG,CAACwB,MAAM,CAAC,CACnGQ,MAAM,CAAC5D,GAAG,CAAC,IAAI,CAAC4B,GAAG,CAACqB,MAAM,CAAE,SAAS,CAAC,CAAC7C,IAAI,CAAC,kBAAkB,CAAC,CACnE,CACJ,CAEAc,YAAYA,CAAA,CACZ,CACI;AACA,IAAI,CAACT,SAAS,CAAG,CAAC,CAAC,CACnB,IAAI,CAACA,SAAS,CAACC,SAAS,CAAG,GAAI,CAAAjC,KAAK,CAACqF,iBAAiB,CAAC,CAAEvE,KAAK,CAAE,QAAQ,CAAEmB,SAAS,CAAE,IAAK,CAAC,CAAC,CAE5F;AACA,IAAI,CAACD,SAAS,CAACG,IAAI,CAAG,GAAI,CAAAlC,cAAc,CAAC,CAAC,CAC1C,IAAI,CAAC+B,SAAS,CAACG,IAAI,CAACmD,UAAU,CAAG,KAAK,CACtC,IAAI,CAACtD,SAAS,CAACG,IAAI,CAACC,QAAQ,CAACC,MAAM,CAACC,KAAK,CAAG,GAAI,CAAAtC,KAAK,CAACuC,KAAK,CAAC,IAAI,CAACzB,KAAK,CAAC,CACvE,IAAI,CAACkB,SAAS,CAACG,IAAI,CAACC,QAAQ,CAACmC,MAAM,CAACjC,KAAK,CAAG,CAAC,CAC7C,IAAI,CAACN,SAAS,CAACG,IAAI,CAACC,QAAQ,CAACmD,WAAW,CAACjD,KAAK,CAAG,IAAI,CACzD,CAEAI,WAAWA,CAAA,CACX,CACI,IAAI,CAAC8C,QAAQ,CAAG,GAAI,CAAAxF,KAAK,CAACyF,aAAa,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CACvD,CAEA9C,SAASA,CAAA,CACT,CACI,GAAG,CAAC,IAAI,CAACpC,KAAK,CACd,CACI,OACJ,CAEA,IAAI,CAACiE,MAAM,CAAG,CAAC,CAAC,CAEhB,IAAI,CAACA,MAAM,CAACkB,MAAM,CAAG,KAAK,CAE1B,IAAI,CAAClB,MAAM,CAAC1C,IAAI,CAAG,GAAI,CAAA9B,KAAK,CAAC2F,IAAI,CAAC,GAAI,CAAA3F,KAAK,CAAC4F,WAAW,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAE,GAAI,CAAA5F,KAAK,CAAC6F,kBAAkB,CAAC,CAAC,CAAC,CACpG,IAAI,CAACrB,MAAM,CAAC1C,IAAI,CAACkB,QAAQ,CAACH,CAAC,CAAG,GAAG,CACjC,IAAI,CAAC2B,MAAM,CAAC1C,IAAI,CAACkB,QAAQ,CAACQ,CAAC,CAAG,CAAE,CAAC,CACjC,IAAI,CAACgB,MAAM,CAAC1C,IAAI,CAAC4C,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CAC7C,IAAI,CAACzE,SAAS,CAACM,GAAG,CAAC,IAAI,CAACiD,MAAM,CAAC1C,IAAI,CAAC,CAEpC,IAAI,CAAC0C,MAAM,CAACsB,iBAAiB,CAAG,GAAI,CAAA5F,iBAAiB,CAAC,IAAI,CAACO,MAAM,CAACsF,QAAQ,CAAE,IAAI,CAACvF,QAAQ,CAACwF,UAAU,CAAC,CACrG,IAAI,CAACxB,MAAM,CAACsB,iBAAiB,CAACG,IAAI,CAAG,GAAG,CACxC,IAAI,CAACzB,MAAM,CAACsB,iBAAiB,CAACI,MAAM,CAAC,IAAI,CAAC1B,MAAM,CAAC1C,IAAI,CAAC,CACtD,IAAI,CAAC0C,MAAM,CAACsB,iBAAiB,CAACpB,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CAC1D,IAAI,CAAClB,MAAM,CAACsB,iBAAiB,CAACK,OAAO,CAAG,IAAI,CAAC3B,MAAM,CAACkB,MAAM,CAE1D,IAAI,CAAClB,MAAM,CAAC4B,MAAM,CAAG,IAAI,CAAC7E,GAAG,CAAC,IAAI,CAACiD,MAAM,CAAC1C,IAAI,CAAE,CAAEuE,KAAK,CAAE,CAAC,CAAEC,KAAK,CAAE,CAAC,CAAErD,OAAO,CAAE,CAAE,IAAI,CAAEvC,KAAK,CAAE,IAAK,CAAC,CAAC,CACrG,IAAI,CAAC8D,MAAM,CAAC4B,MAAM,CAACtE,IAAI,CAAC4C,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CAEpDa,QAAQ,CAACC,gBAAgB,CAAC,SAAS,CAAGC,MAAM,EAC5C,CACI,GAAGA,MAAM,CAACC,GAAG,GAAK,GAAG,CACrB,CACI,IAAI,CAAClC,MAAM,CAACsB,iBAAiB,CAACa,OAAO,CAAC,QAAQ,CAAC,CACnD,CAAC,IACI,IAAGF,MAAM,CAACC,GAAG,GAAK,GAAG,CAC1B,CACI,IAAI,CAAClC,MAAM,CAACsB,iBAAiB,CAACa,OAAO,CAAC,WAAW,CAAC,CACtD,CACJ,CAAC,CAAC,CAEF,IAAI,CAACnC,MAAM,CAACsB,iBAAiB,CAACU,gBAAgB,CAAC,kBAAkB,CAAGC,MAAM,EAC1E,CACI,IAAI,CAAChG,MAAM,CAACmG,aAAa,CAACT,OAAO,CAAG,CAACM,MAAM,CAACnE,KAAK,CACrD,CAAC,CAAC,CAEF,IAAI,CAACrB,SAAS,CAACM,GAAG,CAAC,IAAI,CAACiD,MAAM,CAACsB,iBAAiB,CAAC,CAEjD;AACA,GAAG,IAAI,CAACvF,KAAK,CACb,CACI,KAAM,CAAA4E,MAAM,CAAG,IAAI,CAAC9D,WAAW,CAACC,SAAS,CAAC,QAAQ,CAAC,CACnD6D,MAAM,CAACC,IAAI,CAAC,CAAC,CAEbD,MAAM,CAAC5D,GAAG,CAAC,IAAI,CAACiD,MAAM,CAAE,QAAQ,CAAC,CAAC7C,IAAI,CAAC,SAAS,CAAC,CAACC,QAAQ,CAAC,IAC3D,CACI,IAAI,CAAC4C,MAAM,CAAC1C,IAAI,CAAC4C,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CAE7C,IAAI,CAAClB,MAAM,CAACsB,iBAAiB,CAACpB,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CAC1D,IAAI,CAAClB,MAAM,CAACsB,iBAAiB,CAACK,OAAO,CAAG,IAAI,CAAC3B,MAAM,CAACkB,MAAM,CAE1D,IAAI,CAAClB,MAAM,CAAC4B,MAAM,CAACtE,IAAI,CAAC4C,OAAO,CAAG,IAAI,CAACF,MAAM,CAACkB,MAAM,CACxD,CAAC,CAAC,CACN,CACJ,CAEAnE,GAAGA,CAACsF,UAAU,CACd,IADgB,CAAAxG,QAAQ,CAAAyG,SAAA,CAAA5B,MAAA,IAAA4B,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,CAAC,CAAC,CAEzB,KAAM,CAAAV,MAAM,CAAG,CAAC,CAAC,CAEjB;AACAA,MAAM,CAACnD,OAAO,CAAG,MAAO,CAAA5C,QAAQ,CAAC4C,OAAO,GAAK,WAAW,CAAG,CAAC,CAAG5C,QAAQ,CAAC4C,OAAO,CAC/EmD,MAAM,CAAC1F,KAAK,CAAG,MAAO,CAAAL,QAAQ,CAACK,KAAK,GAAK,WAAW,CAAG,CAAC,CAAGL,QAAQ,CAACK,KAAK,CAEzE;AACA0F,MAAM,CAACrD,SAAS,CAAG8D,UAAU,CAE7B;AACAT,MAAM,CAACrE,QAAQ,CAAG,IAAI,CAACC,SAAS,CAACG,IAAI,CAACkB,KAAK,CAAC,CAAC,CAE7C;AACA+C,MAAM,CAACtE,IAAI,CAAG,GAAI,CAAA9B,KAAK,CAAC2F,IAAI,CAAC,IAAI,CAACH,QAAQ,CAAE,IAAI,CAACzE,gBAAgB,CAAG,IAAI,CAACiB,SAAS,CAACC,SAAS,CAAGmE,MAAM,CAACrE,QAAQ,CAAC,CAC/GqE,MAAM,CAACtE,IAAI,CAACkB,QAAQ,CAACH,CAAC,CAAG,IAAI,CAAChC,iBAAiB,CAC/CuF,MAAM,CAACtE,IAAI,CAACkF,KAAK,CAACC,GAAG,CAAC5G,QAAQ,CAACgG,KAAK,CAAEhG,QAAQ,CAACiG,KAAK,CAAE,GAAG,CAAC,CAE1D;AACA,IAAI,CAACrF,SAAS,CAACM,GAAG,CAAC6E,MAAM,CAACtE,IAAI,CAAC,CAC/B,IAAI,CAACd,KAAK,CAACkG,IAAI,CAACd,MAAM,CAAC,CAEvB,MAAO,CAAAA,MAAM,CACjB,CACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}