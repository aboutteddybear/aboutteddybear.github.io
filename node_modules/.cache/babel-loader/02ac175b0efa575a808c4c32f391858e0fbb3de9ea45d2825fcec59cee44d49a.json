{"ast":null,"code":"import*as THREE from'three';export default class Tiles{constructor(_options){// Options\nthis.resources=_options.resources;this.objects=_options.objects;this.debug=_options.debug;// Set up\nthis.items=[];this.interDistance=1.5;this.tangentDistance=0.3;this.positionRandomess=0.3;this.rotationRandomess=0.1;this.setModels();}setModels(){this.models={};this.models.items=[{base:this.resources.items.tilesABase.scene,collision:this.resources.items.tilesACollision.scene,chances:8},{base:this.resources.items.tilesBBase.scene,collision:this.resources.items.tilesBCollision.scene,chances:1},{base:this.resources.items.tilesCBase.scene,collision:this.resources.items.tilesCCollision.scene,chances:2},{base:this.resources.items.tilesDBase.scene,collision:this.resources.items.tilesDCollision.scene,chances:4},{base:this.resources.items.tilesEBase.scene,collision:this.resources.items.tilesECollision.scene,chances:2}];const totalChances=this.models.items.reduce((_totalChances,_item)=>_totalChances+_item.chances,0);let chances=0;this.models.items=this.models.items.map(_item=>{// Update chances\n_item.minChances=chances;chances+=_item.chances/totalChances;_item.maxChances=chances;// Update rotation\n_item.rotationIndex=0;return _item;});this.models.pick=()=>{const random=Math.random();const model=this.models.items.find(_item=>random>=_item.minChances&&random<=_item.maxChances);model.rotationIndex++;if(model.rotationIndex>3){model.rotationIndex=0;}return model;};}add(_options){const tilePath={};tilePath.start=_options.start;tilePath.delta=_options.delta;tilePath.distance=tilePath.delta.length();tilePath.count=Math.floor(tilePath.distance/this.interDistance);tilePath.directionVector=tilePath.delta.clone().normalize();tilePath.interVector=tilePath.directionVector.clone().multiplyScalar(this.interDistance);tilePath.centeringVector=tilePath.delta.clone().sub(tilePath.interVector.clone().multiplyScalar(tilePath.count));tilePath.tangentVector=tilePath.directionVector.clone().rotateAround(new THREE.Vector2(0,0),Math.PI*0.5).multiplyScalar(this.tangentDistance);tilePath.angle=tilePath.directionVector.angle();// Create tiles\nfor(let i=0;i<tilePath.count;i++){// Model\nconst model=this.models.pick();// Position\nconst position=tilePath.start.clone().add(tilePath.interVector.clone().multiplyScalar(i)).add(tilePath.centeringVector);position.x+=(Math.random()-0.5)*this.positionRandomess;position.y+=(Math.random()-0.5)*this.positionRandomess;const tangent=tilePath.tangentVector;if(i%1===0){tangent.negate();}position.add(tangent);// Rotation\nlet rotation=tilePath.angle;rotation+=(Math.random()-0.5)*this.rotationRandomess;rotation+=model.rotationIndex/4*Math.PI*2;// Tile\nthis.objects.add({base:model.base,collision:model.collision,offset:new THREE.Vector3(position.x,position.y,0),rotation:new THREE.Euler(0,0,rotation),duplicated:true,mass:0});}}}","map":{"version":3,"names":["THREE","Tiles","constructor","_options","resources","objects","debug","items","interDistance","tangentDistance","positionRandomess","rotationRandomess","setModels","models","base","tilesABase","scene","collision","tilesACollision","chances","tilesBBase","tilesBCollision","tilesCBase","tilesCCollision","tilesDBase","tilesDCollision","tilesEBase","tilesECollision","totalChances","reduce","_totalChances","_item","map","minChances","maxChances","rotationIndex","pick","random","Math","model","find","add","tilePath","start","delta","distance","length","count","floor","directionVector","clone","normalize","interVector","multiplyScalar","centeringVector","sub","tangentVector","rotateAround","Vector2","PI","angle","i","position","x","y","tangent","negate","rotation","offset","Vector3","Euler","duplicated","mass"],"sources":["C:/laragon/www/folio-2019/src/javascript/World/Tiles.js"],"sourcesContent":["import * as THREE from 'three'\r\n\r\nexport default class Tiles\r\n{\r\n    constructor(_options)\r\n    {\r\n        // Options\r\n        this.resources = _options.resources\r\n        this.objects = _options.objects\r\n        this.debug = _options.debug\r\n\r\n        // Set up\r\n        this.items = []\r\n        this.interDistance = 1.5\r\n        this.tangentDistance = 0.3\r\n        this.positionRandomess = 0.3\r\n        this.rotationRandomess = 0.1\r\n\r\n        this.setModels()\r\n    }\r\n\r\n    setModels()\r\n    {\r\n        this.models = {}\r\n\r\n        this.models.items = [\r\n            {\r\n                base: this.resources.items.tilesABase.scene,\r\n                collision: this.resources.items.tilesACollision.scene,\r\n                chances: 8\r\n            },\r\n            {\r\n                base: this.resources.items.tilesBBase.scene,\r\n                collision: this.resources.items.tilesBCollision.scene,\r\n                chances: 1\r\n            },\r\n            {\r\n                base: this.resources.items.tilesCBase.scene,\r\n                collision: this.resources.items.tilesCCollision.scene,\r\n                chances: 2\r\n            },\r\n            {\r\n                base: this.resources.items.tilesDBase.scene,\r\n                collision: this.resources.items.tilesDCollision.scene,\r\n                chances: 4\r\n            },\r\n            {\r\n                base: this.resources.items.tilesEBase.scene,\r\n                collision: this.resources.items.tilesECollision.scene,\r\n                chances: 2\r\n            }\r\n        ]\r\n\r\n        const totalChances = this.models.items.reduce((_totalChances, _item) => _totalChances + _item.chances, 0)\r\n        let chances = 0\r\n        this.models.items = this.models.items.map((_item) =>\r\n        {\r\n            // Update chances\r\n            _item.minChances = chances\r\n\r\n            chances += _item.chances / totalChances\r\n            _item.maxChances = chances\r\n\r\n            // Update rotation\r\n            _item.rotationIndex = 0\r\n\r\n            return _item\r\n        })\r\n\r\n        this.models.pick = () =>\r\n        {\r\n            const random = Math.random()\r\n            const model =  this.models.items.find((_item) => random >= _item.minChances && random <= _item.maxChances)\r\n            model.rotationIndex++\r\n\r\n            if(model.rotationIndex > 3)\r\n            {\r\n                model.rotationIndex = 0\r\n            }\r\n\r\n            return model\r\n        }\r\n    }\r\n\r\n    add(_options)\r\n    {\r\n        const tilePath = {}\r\n        tilePath.start = _options.start\r\n        tilePath.delta = _options.delta\r\n\r\n        tilePath.distance = tilePath.delta.length()\r\n        tilePath.count = Math.floor(tilePath.distance / this.interDistance)\r\n        tilePath.directionVector = tilePath.delta.clone().normalize()\r\n        tilePath.interVector = tilePath.directionVector.clone().multiplyScalar(this.interDistance)\r\n        tilePath.centeringVector = tilePath.delta.clone().sub(tilePath.interVector.clone().multiplyScalar(tilePath.count))\r\n        tilePath.tangentVector = tilePath.directionVector.clone().rotateAround(new THREE.Vector2(0, 0), Math.PI * 0.5).multiplyScalar(this.tangentDistance)\r\n        tilePath.angle = tilePath.directionVector.angle()\r\n\r\n        // Create tiles\r\n        for(let i = 0; i < tilePath.count; i++)\r\n        {\r\n            // Model\r\n            const model = this.models.pick()\r\n\r\n            // Position\r\n            const position = tilePath.start.clone().add(tilePath.interVector.clone().multiplyScalar(i)).add(tilePath.centeringVector)\r\n            position.x += (Math.random() - 0.5) * this.positionRandomess\r\n            position.y += (Math.random() - 0.5) * this.positionRandomess\r\n\r\n            const tangent = tilePath.tangentVector\r\n\r\n            if(i % 1 === 0)\r\n            {\r\n                tangent.negate()\r\n            }\r\n\r\n            position.add(tangent)\r\n\r\n            // Rotation\r\n            let rotation = tilePath.angle\r\n            rotation += (Math.random() - 0.5) * this.rotationRandomess\r\n            rotation += model.rotationIndex / 4 * Math.PI * 2\r\n\r\n            // Tile\r\n            this.objects.add({\r\n                base: model.base,\r\n                collision: model.collision,\r\n                offset: new THREE.Vector3(position.x, position.y, 0),\r\n                rotation: new THREE.Euler(0, 0, rotation),\r\n                duplicated: true,\r\n                mass: 0\r\n            })\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}