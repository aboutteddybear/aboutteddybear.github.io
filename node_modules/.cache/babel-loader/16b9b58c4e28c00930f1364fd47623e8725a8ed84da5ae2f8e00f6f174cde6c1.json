{"ast":null,"code":"import EventEmitter from'./EventEmitter.js';import{GLTFLoader}from'three/examples/jsm/loaders/GLTFLoader.js';import{FBXLoader}from'three/examples/jsm/loaders/FBXLoader.js';import{DRACOLoader}from'three/examples/jsm/loaders/DRACOLoader.js';export default class Resources extends EventEmitter{/**\r\n     * Constructor\r\n     */constructor(){super();this.setLoaders();this.toLoad=0;this.loaded=0;this.items={};}/**\r\n     * Set loaders\r\n     */setLoaders(){this.loaders=[];// Images\nthis.loaders.push({extensions:['jpg','png','webp'],action:_resource=>{const image=new Image();image.addEventListener('load',()=>{this.fileLoadEnd(_resource,image);});image.addEventListener('error',()=>{this.fileLoadEnd(_resource,image);});image.src=_resource.source;}});// Draco\nconst dracoLoader=new DRACOLoader();dracoLoader.setDecoderPath('draco/');dracoLoader.setDecoderConfig({type:'js'});this.loaders.push({extensions:['drc'],action:_resource=>{dracoLoader.load(_resource.source,_data=>{this.fileLoadEnd(_resource,_data);DRACOLoader.releaseDecoderModule();});}});// GLTF\nconst gltfLoader=new GLTFLoader();gltfLoader.setDRACOLoader(dracoLoader);this.loaders.push({extensions:['glb','gltf'],action:_resource=>{gltfLoader.load(_resource.source,_data=>{this.fileLoadEnd(_resource,_data);});}});// FBX\nconst fbxLoader=new FBXLoader();this.loaders.push({extensions:['fbx'],action:_resource=>{fbxLoader.load(_resource.source,_data=>{this.fileLoadEnd(_resource,_data);});}});}/**\r\n     * Load\r\n     */load(){let _resources=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];for(const _resource of _resources){this.toLoad++;const extensionMatch=_resource.source.match(/\\.([a-z]+)$/);if(typeof extensionMatch[1]!=='undefined'){const extension=extensionMatch[1];const loader=this.loaders.find(_loader=>_loader.extensions.find(_extension=>_extension===extension));if(loader){loader.action(_resource);}else{console.warn(\"Cannot found loader for \".concat(_resource));}}else{console.warn(\"Cannot found extension of \".concat(_resource));}}}/**\r\n     * File load end\r\n     */fileLoadEnd(_resource,_data){this.loaded++;this.items[_resource.name]=_data;this.trigger('fileEnd',[_resource,_data]);if(this.loaded===this.toLoad){this.trigger('end');}}}","map":{"version":3,"names":["EventEmitter","GLTFLoader","FBXLoader","DRACOLoader","Resources","constructor","setLoaders","toLoad","loaded","items","loaders","push","extensions","action","_resource","image","Image","addEventListener","fileLoadEnd","src","source","dracoLoader","setDecoderPath","setDecoderConfig","type","load","_data","releaseDecoderModule","gltfLoader","setDRACOLoader","fbxLoader","_resources","arguments","length","undefined","extensionMatch","match","extension","loader","find","_loader","_extension","console","warn","concat","name","trigger"],"sources":["C:/laragon/www/folio-2019/src/javascript/Utils/Loader.js"],"sourcesContent":["import EventEmitter from './EventEmitter.js'\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js'\r\nimport { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader.js'\r\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js'\r\n\r\nexport default class Resources extends EventEmitter\r\n{\r\n    /**\r\n     * Constructor\r\n     */\r\n    constructor()\r\n    {\r\n        super()\r\n\r\n        this.setLoaders()\r\n\r\n        this.toLoad = 0\r\n        this.loaded = 0\r\n        this.items = {}\r\n    }\r\n\r\n    /**\r\n     * Set loaders\r\n     */\r\n    setLoaders()\r\n    {\r\n        this.loaders = []\r\n\r\n        // Images\r\n        this.loaders.push({\r\n            extensions: ['jpg', 'png', 'webp'],\r\n            action: (_resource) =>\r\n            {\r\n                const image = new Image()\r\n\r\n                image.addEventListener('load', () =>\r\n                {\r\n                    this.fileLoadEnd(_resource, image)\r\n                })\r\n\r\n                image.addEventListener('error', () =>\r\n                {\r\n                    this.fileLoadEnd(_resource, image)\r\n                })\r\n\r\n                image.src = _resource.source\r\n            }\r\n        })\r\n\r\n        // Draco\r\n        const dracoLoader = new DRACOLoader()\r\n        dracoLoader.setDecoderPath('draco/')\r\n        dracoLoader.setDecoderConfig({ type: 'js' })\r\n\r\n        this.loaders.push({\r\n            extensions: ['drc'],\r\n            action: (_resource) =>\r\n            {\r\n                dracoLoader.load(_resource.source, (_data) =>\r\n                {\r\n                    this.fileLoadEnd(_resource, _data)\r\n\r\n                    DRACOLoader.releaseDecoderModule()\r\n                })\r\n            }\r\n        })\r\n\r\n        // GLTF\r\n        const gltfLoader = new GLTFLoader()\r\n        gltfLoader.setDRACOLoader(dracoLoader)\r\n\r\n        this.loaders.push({\r\n            extensions: ['glb', 'gltf'],\r\n            action: (_resource) =>\r\n            {\r\n                gltfLoader.load(_resource.source, (_data) =>\r\n                {\r\n                    this.fileLoadEnd(_resource, _data)\r\n                })\r\n            }\r\n        })\r\n\r\n        // FBX\r\n        const fbxLoader = new FBXLoader()\r\n\r\n        this.loaders.push({\r\n            extensions: ['fbx'],\r\n            action: (_resource) =>\r\n            {\r\n                fbxLoader.load(_resource.source, (_data) =>\r\n                {\r\n                    this.fileLoadEnd(_resource, _data)\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Load\r\n     */\r\n    load(_resources = [])\r\n    {\r\n        for(const _resource of _resources)\r\n        {\r\n            this.toLoad++\r\n            const extensionMatch = _resource.source.match(/\\.([a-z]+)$/)\r\n\r\n            if(typeof extensionMatch[1] !== 'undefined')\r\n            {\r\n                const extension = extensionMatch[1]\r\n                const loader = this.loaders.find((_loader) => _loader.extensions.find((_extension) => _extension === extension))\r\n\r\n                if(loader)\r\n                {\r\n                    loader.action(_resource)\r\n                }\r\n                else\r\n                {\r\n                    console.warn(`Cannot found loader for ${_resource}`)\r\n                }\r\n            }\r\n            else\r\n            {\r\n                console.warn(`Cannot found extension of ${_resource}`)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * File load end\r\n     */\r\n    fileLoadEnd(_resource, _data)\r\n    {\r\n        this.loaded++\r\n        this.items[_resource.name] = _data\r\n\r\n        this.trigger('fileEnd', [_resource, _data])\r\n\r\n        if(this.loaded === this.toLoad)\r\n        {\r\n            this.trigger('end')\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}